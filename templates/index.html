<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI Text to Speech Converter</title>
    <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --primary: #6C63FF;
            --secondary: #4F46E5;
            --accent: #8B5CF6;
            --success: #10B981;
            --warning: #F59E0B;
            --error: #EF4444;
        }
        
        body {
            font-family: 'Poppins', sans-serif;
            background: linear-gradient(135deg, #f5f7fa 0%, #e4e8f0 100%);
            min-height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 2rem;
            margin: 0;
        }
        
        .card {
            background: #ffffff;
            border-radius: 16px;
            box-shadow: 0 10px 25px -5px rgba(0, 0, 0, 0.1), 0 8px 10px -6px rgba(0, 0, 0, 0.1);
            transition: all 0.3s ease;
            max-width: 800px;
            width: 100%;
            overflow: hidden;
            border: 1px solid #e5e7eb;
        }
        
        .card:hover {
            transform: translateY(-5px);
            box-shadow: 0 15px 35px rgba(0, 0, 0, 0.15);
        }
        
        .btn-primary {
            background: linear-gradient(45deg, var(--primary), var(--secondary));
            transition: all 0.3s ease;
            background-size: 200% auto;
            border: none;
            font-weight: 600;
            letter-spacing: 0.5px;
            text-transform: uppercase;
            box-shadow: 0 4px 15px rgba(108, 99, 255, 0.3);
        }
        
        .btn-primary:hover {
            background-position: right center;
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(108, 99, 255, 0.4);
        }
        
        .btn-primary:active {
            transform: translateY(0);
        }
        
        .form-control {
            transition: all 0.3s ease;
            border: 2px solid #e2e8f0;
            border-radius: 12px;
            padding: 0.75rem 1rem;
            font-size: 1rem;
        }
        
        .form-control:focus {
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(108, 99, 255, 0.2);
        }
        
        .slider {
            width: 100%;
            height: 8px;
            border-radius: 4px;
            background: #e2e8f0;
            outline: none;
            transition: all 0.3s ease;
        }
        
        .slider::-webkit-slider-thumb {
            -webkit-appearance: none;
            appearance: none;
            width: 20px;
            height: 20px;
            border-radius: 50%;
            background: var(--primary);
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .slider::-webkit-slider-thumb:hover {
            transform: scale(1.1);
            box-shadow: 0 0 10px rgba(108, 99, 255, 0.5);
        }
        
        .loading {
            display: none;
        }
        
        .result {
            display: none;
            background: linear-gradient(45deg, #f0f9ff, #e0f2fe);
            border-radius: 12px;
            border-left: 4px solid var(--primary);
        }
        
        .service-tag {
            position: absolute;
            top: -12px;
            right: 20px;
            background: var(--primary);
            color: white;
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 0.75rem;
            font-weight: 600;
            box-shadow: 0 4px 15px rgba(108, 99, 255, 0.3);
        }
        
        .tab-item {
            position: relative;
            padding: 0.75rem 1.5rem;
            font-size: 0.875rem;
            font-weight: 500;
            color: #6b7280;
            background: none;
            border: none;
            border-bottom: 3px solid transparent;
            cursor: pointer;
            outline: none;
            transition: all 0.2s ease;
            margin: 0 0.25rem;
            border-radius: 0.375rem 0.375rem 0 0;
        }
        
        .tab-item:hover {
            color: #4f46e5;
            background-color: rgba(99, 102, 241, 0.1);
        }
        
        .tab-item.active {
            color: #4f46e5;
            border-bottom-color: #4f46e5;
            font-weight: 600;
        }
        
        /* Tech animations */
        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }
        
        @keyframes gradient {
            0% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
            100% { background-position: 0% 50%; }
        }
        
        .animate-float {
            animation: float 6s ease-in-out infinite;
        }
        
        @keyframes float {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-10px); }
        }
        
        /* Grid pattern */
        .bg-grid-slate-100 {
            background-image: url("data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 32 32' width='32' height='32' fill='none' stroke='rgb(15 23 42/0.04)'%3e%3cpath d='M0 .5H31.5V32'/%3e%3c/svg%3e");
        }
    </style>
</head>
<body>
    <div class="relative w-full max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 flex flex-col">
        <div class="card p-6 sm:p-8 relative">
            <!-- Service Tag -->
            <!-- <div class="service-tag" id="service-tag">TTSMaker</div> -->
            
            <!-- Header -->
            <header class="text-center mb-8">
                <h1 class="text-3xl md:text-4xl font-bold bg-gradient-to-r from-purple-600 to-blue-500 bg-clip-text text-transparent mb-2">
                    AI Text to Speech
                </h1>
                <p class="text-gray-500">Convert your text to natural-sounding speech instantly</p>
            </header>
        
        <!-- Tabs -->
        <div class="flex justify-center mb-8 border-b border-gray-200">
            <div class="flex space-x-1">
                <button class="tab-item active" data-service="ttsmaker">
                    <i class="fas fa-robot mr-2"></i>TTSMaker
                </button>
                <button class="tab-item" data-service="ai_speaker">
                    <i class="fas fa-headphones-alt mr-2"></i>AI Speaker
                </button>
            </div>
        </div>

        <!-- Main Content -->
        <div class="flex flex-col space-y-6">
            <!-- Voice Selection -->
            <div class="flex flex-col space-y-2">
                <label class="block text-sm font-medium text-gray-700" for="voice">
                    <i class="fas fa-voice text-purple-500 mr-2"></i>Voice
                </label>
                <select id="voice" class="form-control w-full">
                    {% for voice in services.ttsmaker.voices %}
                        <option value="{{ voice.id }}" data-service="ttsmaker">{{ voice.name }}</option>
                    {% endfor %}
                    {% for voice in services.ai_speaker.voices %}
                        <option value="{{ voice.id }}" data-service="ai_speaker" style="display: none;">{{ voice.name }}</option>
                    {% endfor %}
                </select>
            </div>

            <!-- Text Input -->
            <div class="space-y-2">
                <label class="block text-sm font-medium text-gray-700" for="text">
                    <i class="fas fa-font text-blue-500 mr-2"></i>Enter your text
                </label>
                <textarea 
                    id="text" 
                    rows="5" 
                    class="form-control w-full" 
                    placeholder="Type or paste your text here..."
                ></textarea>
            </div>

            <!-- Voice Settings -->
            <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                <!-- Speed -->
                <div class="space-y-2">
                    <div class="flex justify-between items-center">
                        <label class="text-sm font-medium text-gray-700">
                            <i class="fas fa-tachometer-alt text-green-500 mr-2"></i>Speed
                        </label>
                        <span id="speed-value" class="text-sm font-mono bg-gray-100 px-2 py-1 rounded">1.0x</span>
                    </div>
                    <input 
                        type="range" 
                        id="speed" 
                        min="0.5" 
                        max="2" 
                        step="0.1" 
                        value="1.0" 
                        class="slider w-full"
                    >
                </div>

                <!-- Pitch -->
                <div class="space-y-2">
                    <div class="flex justify-between items-center">
                        <label class="text-sm font-medium text-gray-700">
                            <i class="fas fa-wave-square text-yellow-500 mr-2"></i>Pitch
                        </label>
                        <span id="pitch-value" class="text-sm font-mono bg-gray-100 px-2 py-1 rounded">1.0x</span>
                    </div>
                    <input 
                        type="range" 
                        id="pitch" 
                        min="0.5" 
                        max="2" 
                        step="0.1" 
                        value="1.0" 
                        class="slider w-full"
                    >
                </div>

                <!-- Volume -->
                <div class="space-y-2">
                    <div class="flex justify-between items-center">
                        <label class="text-sm font-medium text-gray-700">
                            <i class="fas fa-volume-up text-red-500 mr-2"></i>Volume
                        </label>
                        <span id="volume-value" class="text-sm font-mono bg-gray-100 px-2 py-1 rounded">1.0x</span>
                    </div>
                    <input 
                        type="range" 
                        id="volume" 
                        min="0" 
                        max="2" 
                        step="0.1" 
                        value="1.0" 
                        class="slider w-full"
                    >
                </div>
            </div>

            <!-- Convert Button -->
            <div class="pt-2">
                <button 
                    id="convert-btn" 
                    class="btn-primary text-white font-bold py-4 px-8 rounded-xl w-full focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 transform transition-all duration-200 hover:scale-[1.02]"
                >
                    <i class="fas fa-play-circle mr-2"></i>Convert to Speech
                </button>
            </div>

            <!-- Loading Indicator -->
            <div id="loading" class="mt-8 text-center loading">
                <div class="inline-flex items-center space-x-3">
                    <div class="w-8 h-8 border-4 border-purple-500 border-t-transparent rounded-full animate-spin"></div>
                    <span class="text-gray-600 font-medium">Processing your request...</span>
                </div>
            </div>

            <!-- Result Section -->
            <div id="result" class="mt-6 p-6 result">
                <div class="text-center">
                    <div class="inline-flex items-center justify-center w-16 h-16 bg-green-100 rounded-full mb-4">
                        <i class="fas fa-check-circle text-3xl text-green-500"></i>
                    </div>
                    <h3 class="text-xl font-semibold text-gray-800 mb-2">Ready to Download!</h3>
                    <p class="text-gray-600 mb-6">Your audio file has been generated successfully</p>
                    
                    <div class="mb-6">
                        <audio id="audio-preview" controls class="w-full rounded-lg shadow-sm"></audio>
                    </div>
                    
                    <div class="space-y-3">
                        <a 
                            id="download-btn" 
                            href="#" 
                            class="inline-flex items-center justify-center px-6 py-3 border border-transparent text-base font-medium rounded-md text-white bg-gradient-to-r from-purple-600 to-blue-500 hover:from-purple-700 hover:to-blue-600 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-purple-500 transition-all duration-200 transform hover:-translate-y-0.5"
                        >
                            <i class="fas fa-download mr-2"></i>Download MP3
                        </a>
                        <button 
                            id="new-convert-btn"
                            class="inline-flex items-center justify-center px-6 py-3 border border-gray-300 shadow-sm text-base font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-purple-500 transition-colors duration-200"
                        >
                            <i class="fas fa-redo-alt mr-2"></i>Convert Another
                        </button>
                    </div>
                </div>
            </div>

            <!-- Error Message -->
            <div id="error" class="mt-4 p-4 rounded-lg bg-red-50 border-l-4 border-red-500 hidden">
                <div class="flex">
                    <div class="flex-shrink-0">
                        <i class="fas fa-exclamation-circle text-red-500 text-xl"></i>
                    </div>
                    <div class="ml-3">
                        <p id="error-message" class="text-sm text-red-700"></p>
                    </div>
                </div>
            </div>
            </div>
        </div>

        </div>

        <!-- Tech Footer -->
        <!-- <footer class="mt-8 pt-8 pb-6 relative overflow-hidden"> -->
            <!-- Tech pattern background -->
            <!-- <div class="absolute inset-0 opacity-5">
                <div class="absolute inset-0 bg-grid-slate-100 [mask-image:linear-gradient(0deg,#fff,rgba(255,255,255,0.6))]"></div>
            </div> -->
            
            <!-- <div class="relative">
                <div class="flex flex-col items-center">
                    <div class="w-24 h-0.5 bg-gradient-to-r from-purple-500 to-blue-500 mb-4"></div>
                    <p class="text-sm font-mono text-gray-500 tracking-wider">
                        <span class="text-gray-400">© 2023</span> 
                        <span class="text-transparent bg-clip-text bg-gradient-to-r from-purple-400 to-blue-500 font-medium">TTS CONVERTER</span> 
                        <span class="text-gray-400">|</span> 
                        <span class="relative group">
                            <span class="text-gray-400">Made with</span>
                            <i class="fas fa-heart text-pink-500 mx-0.5 group-hover:scale-110 transition-transform duration-300"></i>
                            <span class="text-gray-400">for everyone</span>
                        </span>
                    </p>
                    <p class="mt-2 text-xs font-mono text-gray-500">
                        <span class="inline-block px-2 py-0.5 bg-gray-800 rounded-full text-gray-300 text-[0.7rem] tracking-wide">
                            <i class="fas fa-code-branch text-blue-400 mr-1"></i>v1.0.0
                        </span>
                        <span class="mx-2 text-gray-400">•</span>
                        <span class="text-gray-500">For educational purposes</span>
                    </p>
                </div>
            </div> -->
        <!-- </footer> -->
    </div>

    <script>
        // Add standard appearance property for better compatibility
        document.addEventListener('DOMContentLoaded', function() {
            // Add standard appearance property to all sliders
            const sliders = document.querySelectorAll('.slider');
            sliders.forEach(slider => {
                slider.style.appearance = 'none';
                slider.style.WebkitAppearance = 'none';
                slider.style.MozAppearance = 'none';
            });
        });

        // DOM Elements
        const voiceSelect = document.getElementById('voice');
        const speedInput = document.getElementById('speed');
        const pitchInput = document.getElementById('pitch');
        const volumeInput = document.getElementById('volume');
        const speedValue = document.getElementById('speed-value');
        const pitchValue = document.getElementById('pitch-value');
        const volumeValue = document.getElementById('volume-value');
        const textInput = document.getElementById('text');
        const convertBtn = document.getElementById('convert-btn');
        const newConvertBtn = document.getElementById('new-convert-btn');
        const loadingDiv = document.getElementById('loading');
        const resultDiv = document.getElementById('result');
        const audioPreview = document.getElementById('audio-preview');
        const downloadBtn = document.getElementById('download-btn');
        const errorDiv = document.getElementById('error');
        const errorMessage = document.getElementById('error-message');
        const serviceTag = document.getElementById('service-tag');
        const tabs = document.querySelectorAll('.tab');

        // Service configuration is passed from Flask template
        let currentService = 'ttsmaker'; // Default service

        // Update slider value displays
        speedInput.addEventListener('input', () => {
            speedValue.textContent = `${speedInput.value}x`;
        });

        pitchInput.addEventListener('input', () => {
            pitchValue.textContent = `${pitchInput.value}x`;
        });

        volumeInput.addEventListener('input', () => {
            volumeValue.textContent = `${volumeInput.value}x`;
        });

        // Tab switching functionality
        const tabItems = document.querySelectorAll('.tab-item');
        tabItems.forEach(tab => {
            tab.addEventListener('click', (e) => {
                e.preventDefault();
                // Update active tab
                tabItems.forEach(t => t.classList.remove('active'));
                tab.classList.add('active');
                
                // Update current service
                currentService = tab.dataset.service;
                
                // Update service tag
                serviceTag.textContent = tab.textContent.trim();
                serviceTag.textContent = tab.textContent.trim();
                
                // Show/hide voice options
                const voices = voiceSelect.querySelectorAll('option');
                voices.forEach(voice => {
                    if (voice.dataset.service === currentService) {
                        voice.style.display = 'block';
                        if (voice.selected) voice.selected = false;
                    } else {
                        voice.style.display = 'none';
                    }
                });
                
                // Select first voice of the service
                const firstVoice = voiceSelect.querySelector(`[data-service="${currentService}"]`);
                if (firstVoice) firstVoice.selected = true;
                
                // Update slider settings
                updateSliderSettings(currentService);
            });
        });

        // Update slider settings based on service
        function updateSliderSettings(service) {
            // Define service configurations in JavaScript
            const serviceConfigs = {
                'ttsmaker': {
                    speeds: [0.5, 0.75, 1.0, 1.25, 1.5, 2.0],
                    pitches: [0.5, 0.75, 1.0, 1.25, 1.5, 2.0],
                    volumes: [0.5, 0.75, 1.0, 1.25, 1.5, 2.0]
                },
                'ai_speaker': {
                    speeds: ['x-slow', 'slow', 'medium', 'fast', 'x-fast'],
                    pitches: ['x-low', 'low', 'medium', 'high', 'x-high'],
                    volumes: ['silent', 'x-soft', 'soft', 'medium', 'loud', 'x-loud']
                }
            };
            
            const serviceConfig = serviceConfigs[service];
            
            // Update speed slider
            if (serviceConfig.speeds && serviceConfig.speeds[0].includes('%')) {
                // Percentage format
                speedInput.min = -50;
                speedInput.max = 100;
                speedInput.step = 5;
                speedInput.value = 0;
                speedValue.textContent = '0%';
            } else {
                // Decimal format
                speedInput.min = 0.5;
                speedInput.max = 2;
                speedInput.step = 0.1;
                speedInput.value = 1.0;
                speedValue.textContent = '1.0x';
            }
            
            // Update pitch slider
            if (serviceConfig.pitches && serviceConfig.pitches[0].includes('%')) {
                pitchInput.min = -50;
                pitchInput.max = 50;
                pitchInput.step = 5;
                pitchInput.value = 0;
                pitchValue.textContent = '0%';
            } else {
                pitchInput.min = 0.5;
                pitchInput.max = 2;
                pitchInput.step = 0.1;
                pitchInput.value = 1.0;
                pitchValue.textContent = '1.0x';
            }
            
            // Update volume slider
            volumeInput.min = 0;
            volumeInput.max = 2;
            volumeInput.step = 0.1;
            volumeInput.value = 1.0;
            volumeValue.textContent = '1.0x';
        }

        // Convert button click handler
        convertBtn.addEventListener('click', convertText);
        
        // New convert button click handler
        newConvertBtn.addEventListener('click', () => {
            resultDiv.style.display = 'none';
            textInput.value = '';
            textInput.focus();
        });
        
        // Handle Enter key in textarea
        textInput.addEventListener('keydown', (e) => {
            if (e.key === 'Enter' && e.ctrlKey) {
                e.preventDefault();
                convertText();
            }
        });

        // Main conversion function
        async function convertText() {
            const text = textInput.value.trim();
            
            // Validate input
            if (!text) {
                showError('Please enter some text to convert');
                return;
            }
            
            // Show loading, hide results and errors
            loadingDiv.style.display = 'block';
            resultDiv.style.display = 'none';
            errorDiv.classList.add('hidden');
            
            // Disable convert button during conversion
            convertBtn.disabled = true;
            convertBtn.innerHTML = '<i class="fas fa-spinner fa-spin mr-2"></i>Converting...';
            
            try {
                // Prepare request data
                const requestData = {
                    text,
                    service: currentService,
                    voice_id: voiceSelect.value,
                    speed: parseFloat(speedInput.value),
                    pitch: parseFloat(pitchInput.value),
                    volume: parseFloat(volumeInput.value)
                };
                
                // Send request to backend
                const response = await fetch('/api/convert', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify(requestData)
                });
                
                const data = await response.json();
                
                if (data.success) {
                    // Update audio player and download link
                    audioPreview.src = data.download_url;
                    downloadBtn.href = data.download_url;
                    downloadBtn.download = data.filename || 'tts-output.mp3';
                    
                    // Show result section
                    resultDiv.style.display = 'block';
                    
                    // Scroll to result
                    resultDiv.scrollIntoView({ behavior: 'smooth' });
                } else {
                    showError(data.error || 'Conversion failed. Please try again.');
                }
            } catch (error) {
                console.error('Error:', error);
                showError('An error occurred: ' + (error.message || 'Please try again later.'));
            } finally {
                // Reset UI
                loadingDiv.style.display = 'none';
                convertBtn.disabled = false;
                convertBtn.innerHTML = '<i class="fas fa-play-circle mr-2"></i>Convert to Speech';
            }
        }

        // Show error message
        function showError(message) {
            errorMessage.textContent = message;
            errorDiv.classList.remove('hidden');
            errorDiv.scrollIntoView({ behavior: 'smooth' });
        }

        // Initialize the page
        document.addEventListener('DOMContentLoaded', () => {
            // Set default active tab
            const defaultTab = document.querySelector('.tab-item[data-service="ttsmaker"]');
            if (defaultTab) {
                defaultTab.click();
            }
            // Focus the textarea
            textInput.focus();
        });
    </script>
</body>
</html>
